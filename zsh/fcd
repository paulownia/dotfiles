#autoload
emulate -L zsh

if ! command -v mdfind 1>/dev/null 2>&1; then
	print -u2 "[ERROR] mdfind is required. This script is intended for macOS."
	return 1
fi

if ! command -v fzf 1>/dev/null 2>&1; then
	print -u2 "[ERROR] fzf is required. Please install it (e.g. type 'brew install fzf')."
	return 0
fi

if [[ -z $1 ]]; then
	return 1
fi

# https://developer.apple.com/library/mac/documentation/Carbon/Conceptual/SpotlightQuery/Concepts/QueryFormat.html
local MD_QUERY="kMDItemContentType == 'public.folder' && kMDItemFSName == '$1*'"

local RESULT=$(mdfind -onlyin ~ "$MD_QUERY" | fzf)

if [ -z "$RESULT" ]; then
	return 1
fi

echo $RESULT
cd $RESULT

