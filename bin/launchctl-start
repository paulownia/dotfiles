#!/bin/bash -e

if ! command -v launchctl 1>/dev/null 2>&1; then
	echo "[ERROR] launchctl is required. This script is intended for macOS." >&2
	exit 1
fi

if ! command -v fzf 1>/dev/null 2>&1; then
	echo "[ERROR] fzf is required. Please install it (e.g. type 'brew install peco')." >&2
	exit 1
fi

SERVICE_NAME=$(launchctl list | grep "^-" | fzf | head -n 1 | cut -f 3)

if [[ -n $SERVICE_NAME ]]; then
	echo "Start ${SERVICE_NAME}"
	launchctl start "${SERVICE_NAME}"
else
	exit 1
fi
